(function(root,factory){if(typeof define==='function'&&define.amd)
  define('p5.play',['@code-dot-org/p5'],function(p5){(factory(p5))});else if(typeof exports==='object')
  factory(require('@code-dot-org/p5'));else factory(root.p5)}(this,function(p5){var DEFAULT_FRAME_RATE=30;p5.prototype.registerMethod('init',function p5PlayInit(){this.camera=new Camera(this,0,0,1);this.camera.init=!1;this.angleMode(this.DEGREES);this.frameRate(DEFAULT_FRAME_RATE);this._defaultCanvasSize={width:400,height:400};var startDate=new Date();this._startTime=startDate.getTime();this._tempCanvas=document.createElement('canvas')});function defineLazyP5Property(name,getter){Object.defineProperty(p5.prototype,name,{configurable:!0,enumerable:!0,get:function(){var context=(this instanceof p5&&!this._isGlobal)?this:window;if(typeof(context._p5PlayProperties)==='undefined'){context._p5PlayProperties={}}
  if(!(name in context._p5PlayProperties)){context._p5PlayProperties[name]=getter.call(context)}
  return context._p5PlayProperties[name]}})}
  function boundConstructorFactory(constructor){if(typeof(constructor)!=='function')
  throw new Error('constructor must be a function');return function createBoundConstructor(){var pInst=this;function F(){var args=Array.prototype.slice.call(arguments);return constructor.apply(this,[pInst].concat(args))}
  F.prototype=constructor.prototype;return F}}
  function createPInstBinder(pInst){return function pInstBind(methodName){var method=pInst[methodName];if(typeof(method)!=='function')
  throw new Error('"'+methodName+'" is not a p5 method');return method.bind(pInst)}}
  var abs=p5.prototype.abs;var radians=p5.prototype.radians;var degrees=p5.prototype.degrees;if(!p5.prototype.originalCreateCanvas_){p5.prototype.originalCreateCanvas_=p5.prototype.createCanvas;p5.prototype.createCanvas=function(){var result=this.originalCreateCanvas_.apply(this,arguments);this.fill(this.color(127,127,127));return result}}
  if(!p5.prototype.originalEllipse_){p5.prototype.originalEllipse_=p5.prototype.ellipse;p5.prototype.ellipse=function(x,y,w,h){w=(w)?w:50;h=(w&&!h)?w:h;this.originalEllipse_(x,y,w,h)}}
  if(!p5.prototype.originalRect_){p5.prototype.originalRect_=p5.prototype.rect;p5.prototype.rect=function(x,y,w,h){w=(w)?w:50;h=(w&&!h)?w:h;this.originalRect_(x,y,w,h)}}
  p5.prototype._ontouchstart=function(e){if(!this._curElement){return}
  var validTouch;for(var i=0;i<e.touches.length;i++){validTouch=getTouchInfo(this._curElement.elt,e,i);if(validTouch){break}}
  if(!validTouch){return}
  var context=this._isGlobal?window:this;var executeDefault;this._updateNextTouchCoords(e);this._updateNextMouseCoords(e);this._setProperty('touchIsDown',!0);if(typeof context.touchStarted==='function'){executeDefault=context.touchStarted(e);if(executeDefault===!1){e.preventDefault()}}else if(typeof context.mousePressed==='function'){executeDefault=context.mousePressed(e);if(executeDefault===!1){e.preventDefault()}}};p5.prototype._updateNextTouchCoords=function(e){var x=this.touchX;var y=this.touchY;if(e.type==='mousedown'||e.type==='mousemove'||e.type==='mouseup'||!e.touches){x=this.mouseX;y=this.mouseY}else{if(this._curElement!==null){var touchInfo=getTouchInfo(this._curElement.elt,e,0);if(touchInfo){x=touchInfo.x;y=touchInfo.y}
  var touches=[];var touchIndex=0;for(var i=0;i<e.touches.length;i++){touchInfo=getTouchInfo(this._curElement.elt,e,i);if(touchInfo){touches[touchIndex]=touchInfo;touchIndex++}}
  this._setProperty('touches',touches)}}
  this._setProperty('touchX',x);this._setProperty('touchY',y);if(!this._hasTouchInteracted){this._updateTouchCoords();this._setProperty('_hasTouchInteracted',!0)}};function getTouchInfo(canvas,e,i){i=i||0;var rect=canvas.getBoundingClientRect();var touch=e.touches[i]||e.changedTouches[i];var xPos=touch.clientX-rect.left;var yPos=touch.clientY-rect.top;if(xPos>=0&&xPos<rect.width&&yPos>=0&&yPos<rect.height){return{x:Math.round(xPos*canvas.offsetWidth/rect.width),y:Math.round(yPos*canvas.offsetHeight/rect.height),id:touch.identifier}}}
  p5.prototype._onmousedown=function(e){if(!this._curElement){return}
  if(!getMousePos(this._curElement.elt,e)){return}
  var context=this._isGlobal?window:this;var executeDefault;this._setProperty('isMousePressed',!0);this._setProperty('mouseIsPressed',!0);this._setMouseButton(e);this._updateNextMouseCoords(e);this._updateNextTouchCoords(e);if(typeof context.mousePressed==='function'){executeDefault=context.mousePressed(e);if(executeDefault===!1){e.preventDefault()}}else if(typeof context.touchStarted==='function'){executeDefault=context.touchStarted(e);if(executeDefault===!1){e.preventDefault()}}};p5.prototype._updateNextMouseCoords=function(e){var x=this.mouseX;var y=this.mouseY;if(e.type==='touchstart'||e.type==='touchmove'||e.type==='touchend'||e.touches){x=this.touchX;y=this.touchY}else if(this._curElement!==null){var mousePos=getMousePos(this._curElement.elt,e);if(mousePos){x=mousePos.x;y=mousePos.y}}
  this._setProperty('mouseX',x);this._setProperty('mouseY',y);this._setProperty('winMouseX',e.pageX);this._setProperty('winMouseY',e.pageY);if(!this._hasMouseInteracted){this._updateMouseCoords();this._setProperty('_hasMouseInteracted',!0)}};function getMousePos(canvas,evt){var rect=canvas.getBoundingClientRect();var xPos=evt.clientX-rect.left;var yPos=evt.clientY-rect.top;if(xPos>=0&&xPos<rect.width&&yPos>=0&&yPos<rect.height){return{x:Math.round(xPos*canvas.offsetWidth/rect.width),y:Math.round(yPos*canvas.offsetHeight/rect.height)}}}
  p5.Vector.project=function(a,b){return p5.Vector.mult(b,p5.Vector.dot(a,b)/p5.Vector.dot(b,b))};p5.Vector.prototype.isParallel=function(v2,tolerance){tolerance=typeof tolerance==='number'?tolerance:1e-14;return(Math.abs(this.x)<tolerance&&Math.abs(v2.x)<tolerance)||(Math.abs(this.y)<tolerance&&Math.abs(v2.y)<tolerance)||(Math.abs(this.x/v2.x-this.y/v2.y)<tolerance)};p5.prototype.loadImageElement=function(path,successCallback,failureCallback){var img=new Image();var decrementPreload=p5._getDecrementPreload.apply(this,arguments);img.onload=function(){if(typeof successCallback==='function'){successCallback(img)}
  if(decrementPreload&&(successCallback!==decrementPreload)){decrementPreload()}};img.onerror=function(e){p5._friendlyFileLoadError(0,img.src);if((typeof failureCallback==='function')&&(failureCallback!==decrementPreload)){failureCallback(e)}};if(path.indexOf('data:image/')!==0){img.crossOrigin='Anonymous'}
  img.src=path;return img};p5.prototype.imageElement=function(imgEl,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight){function _sAssign(sVal,iVal){if(sVal>0&&sVal<iVal){return sVal}else{return iVal}}
  function modeAdjust(a,b,c,d,mode){if(mode===p5.prototype.CORNER){return{x:a,y:b,w:c,h:d}}else if(mode===p5.prototype.CORNERS){return{x:a,y:b,w:c-a,h:d-b}}else if(mode===p5.prototype.RADIUS){return{x:a-c,y:b-d,w:2*c,h:2*d}}else if(mode===p5.prototype.CENTER){return{x:a-c*0.5,y:b-d*0.5,w:c,h:d}}}
  if(arguments.length<=5){dx=sx||0;dy=sy||0;sx=0;sy=0;dWidth=sWidth||imgEl.width;dHeight=sHeight||imgEl.height;sWidth=imgEl.width;sHeight=imgEl.height}else if(arguments.length===9){sx=sx||0;sy=sy||0;sWidth=_sAssign(sWidth,imgEl.width);sHeight=_sAssign(sHeight,imgEl.height);dx=dx||0;dy=dy||0;dWidth=dWidth||imgEl.width;dHeight=dHeight||imgEl.height}else{throw 'Wrong number of arguments to imageElement()'}
  var vals=modeAdjust(dx,dy,dWidth,dHeight,this._renderer._imageMode);if(this._renderer._tint){var context=this._tempCanvas.getContext('2d');if(this._tempCanvas.width<vals.w||this._tempCanvas.height<vals.h){this._tempCanvas.width=Math.max(this._tempCanvas.width,vals.w);this._tempCanvas.height=Math.max(this._tempCanvas.height,vals.h)}else{context.clearRect(0,0,vals.w,vals.h)}
  context.drawImage(imgEl,sx,sy,sWidth,sHeight,0,0,vals.w,vals.h);this._renderer.image({canvas:this._tempCanvas},0,0,vals.w,vals.h,vals.x,vals.y,vals.w,vals.h)}else{this._renderer.image({elt:imgEl},sx,sy,sWidth,sHeight,vals.x,vals.y,vals.w,vals.h)}};defineLazyP5Property('allSprites',function(){return new p5.prototype.Group()});p5.prototype._mouseButtonIsPressed=function(buttonCode){return(this.mouseIsPressed&&this.mouseButton===buttonCode)||(this.touchIsDown&&buttonCode===this.LEFT)};p5.prototype.mouseDidMove=function(){return this.pmouseX!==this.mouseX||this.pmouseY!==this.mouseY};p5.prototype.mouseIsOver=function(sprite){if(!sprite){return!1}
  if(!sprite.collider){sprite.setDefaultCollider()}
  var mousePosition;if(this.camera.active){mousePosition=this.createVector(this.camera.mouseX,this.camera.mouseY)}else{mousePosition=this.createVector(this.mouseX,this.mouseY)}
  return sprite.collider.overlap(new window.p5.PointCollider(mousePosition))};p5.prototype.mousePressedOver=function(sprite){return(this.mouseIsPressed||this.touchIsDown)&&this.mouseIsOver(sprite)};var styleEmpty='rgba(0,0,0,0)';p5.Renderer2D.prototype.regularPolygon=function(x,y,sides,size,rotation){var ctx=this.drawingContext;var doFill=this._doFill,doStroke=this._doStroke;if(doFill&&!doStroke){if(ctx.fillStyle===styleEmpty){return this}}else if(!doFill&&doStroke){if(ctx.strokeStyle===styleEmpty){return this}}
  if(sides<3){return}
  ctx.beginPath();ctx.moveTo(x+size*Math.cos(rotation),y+size*Math.sin(rotation));for(var i=1;i<sides;i++){var angle=rotation+(i*2*Math.PI/sides);ctx.lineTo(x+size*Math.cos(angle),y+size*Math.sin(angle))}
  ctx.closePath();if(doFill){ctx.fill()}
  if(doStroke){ctx.stroke()}};p5.prototype.regularPolygon=function(x,y,sides,size,rotation){if(!this._renderer._doStroke&&!this._renderer._doFill){return this}
  var args=new Array(arguments.length);for(var i=0;i<args.length;++i){args[i]=arguments[i]}
  if(typeof rotation==='undefined'){rotation=-(Math.PI/2);if(0===sides%2){rotation+=Math.PI/sides}}else if(this._angleMode===this.DEGREES){rotation=this.radians(rotation)}
  if(!this._renderer.isP3D){this._validateParameters('regularPolygon',args,[['Number','Number','Number','Number'],['Number','Number','Number','Number','Number']]);this._renderer.regularPolygon(args[0],args[1],args[2],args[3],rotation)}
  return this};p5.Renderer2D.prototype.shape=function(){var ctx=this.drawingContext;var doFill=this._doFill,doStroke=this._doStroke;if(doFill&&!doStroke){if(ctx.fillStyle===styleEmpty){return this}}else if(!doFill&&doStroke){if(ctx.strokeStyle===styleEmpty){return this}}
  var numCoords=arguments.length/2;if(numCoords<1){return}
  ctx.beginPath();ctx.moveTo(arguments[0],arguments[1]);for(var i=1;i<numCoords;i++){ctx.lineTo(arguments[i*2],arguments[i*2+1])}
  ctx.closePath();if(doFill){ctx.fill()}
  if(doStroke){ctx.stroke()}};p5.prototype.shape=function(){if(!this._renderer._doStroke&&!this._renderer._doFill){return this}
  if(!this._renderer.isP3D){this._renderer.shape.apply(this._renderer,arguments)}
  return this};p5.prototype.rgb=function(r,g,b,a){if(!a){a=1}
  a=a*255;return this.color(r,g,b,a)};p5.prototype.createGroup=function(){return new this.Group()};defineLazyP5Property('World',function(){var World={pInst:this};function createReadOnlyP5PropertyAlias(name){Object.defineProperty(World,name,{enumerable:!0,get:function(){return this.pInst[name]}})}
  createReadOnlyP5PropertyAlias('width');createReadOnlyP5PropertyAlias('height');createReadOnlyP5PropertyAlias('mouseX');createReadOnlyP5PropertyAlias('mouseY');createReadOnlyP5PropertyAlias('allSprites');createReadOnlyP5PropertyAlias('frameCount');Object.defineProperty(World,'frameRate',{enumerable:!0,get:function(){return this.pInst.frameRate()},set:function(value){this.pInst.frameRate(value)}});Object.defineProperty(World,'seconds',{enumerable:!0,get:function(){var currentDate=new Date();var currentTime=currentDate.getTime();return Math.round((currentTime-this.pInst._startTime)/1000)}});return World});p5.prototype.spriteUpdate=!0;p5.prototype.createSprite=function(x,y,width,height){var s=new Sprite(this,x,y,width,height);s.depth=this.allSprites.maxDepth()+1;this.allSprites.add(s);return s};p5.prototype.removeSprite=function(sprite){sprite.remove()};p5.prototype.updateSprites=function(upd){if(upd===!1)
  this.spriteUpdate=!1;if(upd===!0)
  this.spriteUpdate=!0;if(this.spriteUpdate)
  for(var i=0;i<this.allSprites.size();i++){this.allSprites.get(i).update()}};p5.prototype.getSprites=function(){if(arguments.length===0){return this.allSprites.toArray()}else{var arr=[];for(var j=0;j<arguments.length;j++){for(var i=0;i<this.allSprites.size();i++){if(this.allSprites.get(i).isTagged(arguments[j]))
  arr.push(this.allSprites.get(i));}}
  return arr}};p5.prototype.drawSprites=function(group){group=group||this.allSprites;if(typeof group.draw!=='function'){throw('Error: with drawSprites you can only draw all sprites or a group')}
  group.draw()};p5.prototype.drawSprite=function(sprite){if(sprite)
  sprite.display();};p5.prototype.loadAnimation=function(){return construct(this.Animation,arguments)};p5.prototype.loadSpriteSheet=function(){return construct(this.SpriteSheet,arguments)};p5.prototype.animation=function(anim,x,y){anim.draw(x,y)};defineLazyP5Property('_p5play',function(){return{keyStates:{},mouseStates:{}}});var KEY_IS_UP=0;var KEY_WENT_DOWN=1;var KEY_IS_DOWN=2;var KEY_WENT_UP=3;p5.prototype.keyWentDown=function(key){return this._isKeyInState(key,KEY_WENT_DOWN)};p5.prototype.keyWentUp=function(key){return this._isKeyInState(key,KEY_WENT_UP)};p5.prototype.keyDown=function(key){return this._isKeyInState(key,KEY_IS_DOWN)};p5.prototype._isKeyInState=function(key,state){var keyCode;var keyStates=this._p5play.keyStates;if(typeof key==='string'){keyCode=this._keyCodeFromAlias(key)}else{keyCode=key}
  if(keyStates[keyCode]===undefined){if(this.keyIsDown(keyCode))
  keyStates[keyCode]=KEY_IS_DOWN;else keyStates[keyCode]=KEY_IS_UP}
  return(keyStates[keyCode]===state)};p5.prototype.mouseDown=function(buttonCode){return this._isMouseButtonInState(buttonCode,KEY_IS_DOWN)};p5.prototype.mouseUp=function(buttonCode){return this._isMouseButtonInState(buttonCode,KEY_IS_UP)};p5.prototype.mouseWentUp=function(buttonCode){return this._isMouseButtonInState(buttonCode,KEY_WENT_UP)};p5.prototype.mouseWentDown=function(buttonCode){return this._isMouseButtonInState(buttonCode,KEY_WENT_DOWN)};p5.prototype._clickKeyFromString=function(buttonCode){if(this.CLICK_KEY[buttonCode]){return this.CLICK_KEY[buttonCode]}else{return buttonCode}};p5.prototype.CLICK_KEY={'leftButton':p5.prototype.LEFT,'rightButton':p5.prototype.RIGHT,'centerButton':p5.prototype.CENTER};p5.prototype._isMouseButtonInState=function(buttonCode,state){var mouseStates=this._p5play.mouseStates;buttonCode=this._clickKeyFromString(buttonCode);if(buttonCode===undefined)
  buttonCode=this.LEFT;if(mouseStates[buttonCode]===undefined){if(this._mouseButtonIsPressed(buttonCode))
  mouseStates[buttonCode]=KEY_IS_DOWN;else mouseStates[buttonCode]=KEY_IS_UP}
  return(mouseStates[buttonCode]===state)};p5.prototype.KEY={'BACKSPACE':8,'TAB':9,'ENTER':13,'SHIFT':16,'CTRL':17,'ALT':18,'PAUSE':19,'CAPS_LOCK':20,'ESC':27,'SPACE':32,' ':32,'PAGE_UP':33,'PAGE_DOWN':34,'END':35,'HOME':36,'LEFT_ARROW':37,'LEFT':37,'UP_ARROW':38,'UP':38,'RIGHT_ARROW':39,'RIGHT':39,'DOWN_ARROW':40,'DOWN':40,'INSERT':45,'DELETE':46,'0':48,'1':49,'2':50,'3':51,'4':52,'5':53,'6':54,'7':55,'8':56,'9':57,'A':65,'B':66,'C':67,'D':68,'E':69,'F':70,'G':71,'H':72,'I':73,'J':74,'K':75,'L':76,'M':77,'N':78,'O':79,'P':80,'Q':81,'R':82,'S':83,'T':84,'U':85,'V':86,'W':87,'X':88,'Y':89,'Z':90,'0NUMPAD':96,'1NUMPAD':97,'2NUMPAD':98,'3NUMPAD':99,'4NUMPAD':100,'5NUMPAD':101,'6NUMPAD':102,'7NUMPAD':103,'8NUMPAD':104,'9NUMPAD':105,'MULTIPLY':106,'PLUS':107,'MINUS':109,'DOT':110,'SLASH1':111,'F1':112,'F2':113,'F3':114,'F4':115,'F5':116,'F6':117,'F7':118,'F8':119,'F9':120,'F10':121,'F11':122,'F12':123,'EQUAL':187,'COMMA':188,'SLASH':191,'BACKSLASH':220};p5.prototype.KEY_DEPRECATIONS={'MINUT':'MINUS','COMA':'COMMA'};p5.prototype._keyCodeFromAlias=function(alias){alias=alias.toUpperCase();if(this.KEY_DEPRECATIONS[alias]){this._warn('Key literal "'+alias+'" is deprecated and may be removed '+'in a future version of p5.play. '+'Please use "'+this.KEY_DEPRECATIONS[alias]+'" instead.');alias=this.KEY_DEPRECATIONS[alias]}
  return this.KEY[alias]};p5.prototype.readPresses=function(){var keyStates=this._p5play.keyStates;var mouseStates=this._p5play.mouseStates;for(var key in keyStates){if(this.keyIsDown(key)){if(keyStates[key]===KEY_IS_UP)
  keyStates[key]=KEY_WENT_DOWN;else keyStates[key]=KEY_IS_DOWN}else{if(keyStates[key]===KEY_IS_DOWN)
  keyStates[key]=KEY_WENT_UP;else keyStates[key]=KEY_IS_UP}}
  for(var btn in mouseStates){if(this._mouseButtonIsPressed(btn)){if(mouseStates[btn]===KEY_IS_UP)
  mouseStates[btn]=KEY_WENT_DOWN;else mouseStates[btn]=KEY_IS_DOWN}else{if(mouseStates[btn]===KEY_IS_DOWN)
  mouseStates[btn]=KEY_WENT_UP;else mouseStates[btn]=KEY_IS_UP}}};p5.prototype.useQuadTree=function(use){if(this.quadTree!==undefined){if(use===undefined)
  return this.quadTree.active;else if(use)
  this.quadTree.active=!0;else this.quadTree.active=!1}else return!1};defineLazyP5Property('quadTree',function(){var quadTree=new Quadtree({x:0,y:0,width:0,height:0},4);quadTree.active=!1;return quadTree});function Sprite(pInst,_x,_y,_w,_h){var pInstBind=createPInstBinder(pInst);var createVector=pInstBind('createVector');var color=pInstBind('color');var print=pInstBind('print');var push=pInstBind('push');var pop=pInstBind('pop');var colorMode=pInstBind('colorMode');var tint=pInstBind('tint');var lerpColor=pInstBind('lerpColor');var noStroke=pInstBind('noStroke');var rectMode=pInstBind('rectMode');var ellipseMode=pInstBind('ellipseMode');var imageMode=pInstBind('imageMode');var translate=pInstBind('translate');var scale=pInstBind('scale');var rotate=pInstBind('rotate');var stroke=pInstBind('stroke');var strokeWeight=pInstBind('strokeWeight');var line=pInstBind('line');var noFill=pInstBind('noFill');var fill=pInstBind('fill');var textAlign=pInstBind('textAlign');var textSize=pInstBind('textSize');var text=pInstBind('text');var rect=pInstBind('rect');var cos=pInstBind('cos');var sin=pInstBind('sin');var atan2=pInstBind('atan2');var quadTree=pInst.quadTree;var camera=pInst.camera;var RGB=p5.prototype.RGB;var CENTER=p5.prototype.CENTER;var LEFT=p5.prototype.LEFT;var BOTTOM=p5.prototype.BOTTOM;this.position=createVector(_x,_y);this.previousPosition=createVector(_x,_y);this.newPosition=createVector(_x,_y);this.deltaX=0;this.deltaY=0;this.velocity=createVector(0,0);this.maxSpeed=-1;this.friction=0;this.collider=undefined;this.touching={};this.touching.left=!1;this.touching.right=!1;this.touching.top=!1;this.touching.bottom=!1;this.mass=1;this.immovable=!1;this.restitution=1;Object.defineProperty(this,'rotation',{enumerable:!0,get:function(){return this._rotation},set:function(value){this._rotation=value;if(this.rotateToDirection){this.setSpeed(this.getSpeed(),value)}}});this._rotation=0;this.rotationSpeed=0;this.rotateToDirection=!1;this.depth=0;this.scale=1;var dirX=1;var dirY=1;this.visible=!0;this.mouseActive=!1;this.mouseIsOver=!1;this.mouseIsPressed=!1;this._internalWidth=_w;this._internalHeight=_h;this._horizontalStretch=1;this._verticalStretch=1;Object.defineProperty(this,'width',{enumerable:!0,configurable:!0,get:function(){if(this._internalWidth===undefined){return 100}else if(this.animation&&pInst._fixedSpriteAnimationFrameSizes){return this._internalWidth*this._horizontalStretch}else{return this._internalWidth}},set:function(value){if(this.animation&&pInst._fixedSpriteAnimationFrameSizes){this._horizontalStretch=value/this._internalWidth}else{this._internalWidth=value}}});if(_w===undefined)
  this.width=100;else this.width=_w;Object.defineProperty(this,'height',{enumerable:!0,configurable:!0,get:function(){if(this._internalHeight===undefined){return 100}else if(this.animation&&pInst._fixedSpriteAnimationFrameSizes){return this._internalHeight*this._verticalStretch}else{return this._internalHeight}},set:function(value){if(this.animation&&pInst._fixedSpriteAnimationFrameSizes){this._verticalStretch=value/this._internalHeight}else{this._internalHeight=value}}});if(_h===undefined)
  this.height=100;else this.height=_h;this.originalWidth=this._internalWidth;this.originalHeight=this._internalHeight;this.getScaledWidth=function(){return this.width*this.scale};this.getScaledHeight=function(){return this.height*this.scale};this.removed=!1;this.life=-1;this.debug=!1;this.shapeColor=color(127,127,127);this.groups=[];var animations={};var currentAnimation='';this.animation=undefined;this._sweptCollider=undefined;Object.defineProperty(this,'x',{enumerable:!0,get:function(){return this.position.x},set:function(value){this.position.x=value}});Object.defineProperty(this,'y',{enumerable:!0,get:function(){return this.position.y},set:function(value){this.position.y=value}});Object.defineProperty(this,'velocityX',{enumerable:!0,get:function(){return this.velocity.x},set:function(value){this.velocity.x=value}});Object.defineProperty(this,'velocityY',{enumerable:!0,get:function(){return this.velocity.y},set:function(value){this.velocity.y=value}});Object.defineProperty(this,'lifetime',{enumerable:!0,get:function(){return this.life},set:function(value){this.life=value}});Object.defineProperty(this,'bounciness',{enumerable:!0,get:function(){return this.restitution},set:function(value){this.restitution=value}});Object.defineProperty(this,'frameDelay',{enumerable:!0,get:function(){return this.animation&&this.animation.frameDelay},set:function(value){if(this.animation){this.animation.frameDelay=value}}});this._getBroadPhaseCollider=function(){return(this.velocity.magSq()>0)?this._sweptCollider:this.collider};this._doSweptCollidersOverlap=function(target){var displacement=this._getBroadPhaseCollider().collide(target._getBroadPhaseCollider());return displacement.x!==0||displacement.y!==0};this._syncAnimationSizes=function(animations,currentAnimation){if(pInst._fixedSpriteAnimationFrameSizes){return}
  if(animations[currentAnimation].frameChanged||this.width===undefined||this.height===undefined){this._internalWidth=animations[currentAnimation].getWidth()*abs(this._getScaleX());this._internalHeight=animations[currentAnimation].getHeight()*abs(this._getScaleY())}};this.update=function(){if(!this.removed){if(this._sweptCollider&&this.velocity.magSq()>0){this._sweptCollider.updateSweptColliderFromSprite(this)}
  if(this.newPosition!==this.position)
  this.previousPosition=createVector(this.newPosition.x,this.newPosition.y);else this.previousPosition=createVector(this.position.x,this.position.y);this.velocity.x*=1-this.friction;this.velocity.y*=1-this.friction;if(this.maxSpeed!==-1)
  this.limitSpeed(this.maxSpeed);if(this.rotateToDirection&&this.velocity.mag()>0)
  this._rotation=this.getDirection();this.rotation+=this.rotationSpeed;this.position.x+=this.velocity.x;this.position.y+=this.velocity.y;this.newPosition=createVector(this.position.x,this.position.y);this.deltaX=this.position.x-this.previousPosition.x;this.deltaY=this.position.y-this.previousPosition.y;if(animations[currentAnimation]){animations[currentAnimation].update();this._syncAnimationSizes(animations,currentAnimation)}
  if(this.collider){this.collider.updateFromSprite(this)}
  if(this.mouseActive){if(!this.collider)
  this.setDefaultCollider();this.mouseUpdate()}else{if(typeof(this.onMouseOver)==='function'||typeof(this.onMouseOut)==='function'||typeof(this.onMousePressed)==='function'||typeof(this.onMouseReleased)==='function'){this.mouseActive=!0;if(!this.collider)
  this.setDefaultCollider();this.mouseUpdate()}}
  if(this.life>0)
  this.life--;if(this.life===0)
  this.remove();}};this.setDefaultCollider=function(){if(animations[currentAnimation]&&animations[currentAnimation].getWidth()===1&&animations[currentAnimation].getHeight()===1){return}
  this.setCollider('rectangle')};this.mouseUpdate=function(){var mouseWasOver=this.mouseIsOver;var mouseWasPressed=this.mouseIsPressed;this.mouseIsOver=!1;this.mouseIsPressed=!1;if(this.collider){var mousePosition;if(camera.active)
  mousePosition=createVector(camera.mouseX,camera.mouseY);else mousePosition=createVector(pInst.mouseX,pInst.mouseY);this.mouseIsOver=this.collider.overlap(new p5.PointCollider(mousePosition));if(this.mouseIsOver&&(pInst.mouseIsPressed||pInst.touchIsDown))
  this.mouseIsPressed=!0;if(!mouseWasOver&&this.mouseIsOver&&this.onMouseOver!==undefined)
  if(typeof(this.onMouseOver)==='function')
  this.onMouseOver.call(this,this);else print('Warning: onMouseOver should be a function');if(mouseWasOver&&!this.mouseIsOver&&this.onMouseOut!==undefined)
  if(typeof(this.onMouseOut)==='function')
  this.onMouseOut.call(this,this);else print('Warning: onMouseOut should be a function');if(!mouseWasPressed&&this.mouseIsPressed&&this.onMousePressed!==undefined)
  if(typeof(this.onMousePressed)==='function')
  this.onMousePressed.call(this,this);else print('Warning: onMousePressed should be a function');if(mouseWasPressed&&!pInst.mouseIsPressed&&!this.mouseIsPressed&&this.onMouseReleased!==undefined)
  if(typeof(this.onMouseReleased)==='function')
  this.onMouseReleased.call(this,this);else print('Warning: onMouseReleased should be a function')}};this.setCollider=function(type,offsetX,offsetY,width,height,rotation){var _type=type?type.toLowerCase():'';if(_type==='rectangle'){_type='obb'}
  if(!(_type==='point'||_type==='circle'||_type==='obb'||_type==='aabb')){throw new TypeError('setCollider expects the first argument to be one of "point", "circle", "rectangle", "aabb" or "obb"')}else if(_type==='point'&&!(arguments.length===1||arguments.length===3)){throw new TypeError('Usage: setCollider("'+type+'"[, offsetX, offsetY])')}else if(_type==='circle'&&!(arguments.length===1||arguments.length===3||arguments.length===4)){throw new TypeError('Usage: setCollider("'+type+'"[, offsetX, offsetY[, radius]])')}else if(_type==='aabb'&&!(arguments.length===1||arguments.length===3||arguments.length===5)){throw new TypeError('Usage: setCollider("'+type+'"[, offsetX, offsetY[, width, height]])')}else if(_type==='obb'&&!(arguments.length===1||arguments.length===3||arguments.length===5||arguments.length===6)){throw new TypeError('Usage: setCollider("'+type+'"[, offsetX, offsetY[, width, height[, rotation]]])')}
  var offset=createVector(offsetX,offsetY);if(_type==='point'){this.collider=p5.PointCollider.createFromSprite(this,offset)}else if(_type==='circle'){this.collider=p5.CircleCollider.createFromSprite(this,offset,width)}else if(_type==='aabb'){this.collider=p5.AxisAlignedBoundingBoxCollider.createFromSprite(this,offset,width,height)}else if(_type==='obb'){this.collider=p5.OrientedBoundingBoxCollider.createFromSprite(this,offset,width,height,radians(rotation))}
  this._sweptCollider=new p5.OrientedBoundingBoxCollider()};this.mirrorX=function(dir){if(dir===1||dir===-1)
  dirX=dir;else return dirX};this.mirrorY=function(dir){if(dir===1||dir===-1)
  dirY=dir;else return dirY};this._getScaleX=function(){if(pInst._fixedSpriteAnimationFrameSizes){return this.scale*this._horizontalStretch}
  return this.scale};this._getScaleY=function(){if(pInst._fixedSpriteAnimationFrameSizes){return this.scale*this._verticalStretch}
  return this.scale};this.display=function(){if(this.visible&&!this.removed){push();colorMode(RGB);noStroke();rectMode(CENTER);ellipseMode(CENTER);imageMode(CENTER);translate(this.position.x,this.position.y);if(pInst._angleMode===pInst.RADIANS){rotate(radians(this.rotation))}else{rotate(this.rotation)}
  scale(this._getScaleX()*dirX,this._getScaleY()*dirY);this.draw();pop();if(this.debug){push();stroke(0,255,0);strokeWeight(1);line(this.position.x-10,this.position.y,this.position.x+10,this.position.y);line(this.position.x,this.position.y-10,this.position.x,this.position.y+10);noFill();noStroke();fill(0,255,0);textAlign(LEFT,BOTTOM);textSize(16);text(this.depth+'',this.position.x+4,this.position.y-2);noFill();stroke(0,255,0);if(this.collider===undefined){this.setDefaultCollider()}
  if(this.collider){this.collider.draw(pInst)}
  pop()}}};this.draw=function(){if(currentAnimation!==''&&animations){if(animations[currentAnimation]){if(this.tint){push();tint(this.tint)}
  animations[currentAnimation].draw(0,0,0);if(this.tint){pop()}}}else{var fillColor=this.shapeColor;if(this.tint){fillColor=lerpColor(color(fillColor),color(this.tint),0.5)}
  noStroke();fill(fillColor);rect(0,0,this._internalWidth,this._internalHeight)}};this.remove=function(){this.removed=!0;quadTree.removeObject(this);while(this.groups.length>0){this.groups[0].remove(this)}};this.destroy=this.remove;this.setVelocity=function(x,y){this.velocity.x=x;this.velocity.y=y};this.getSpeed=function(){return this.velocity.mag()};this.getDirection=function(){var direction=atan2(this.velocity.y,this.velocity.x);if(isNaN(direction))
  direction=0;if(pInst._angleMode===pInst.RADIANS){direction=degrees(direction)}
  return direction};this.addToGroup=function(group){if(group instanceof Array)
  group.add(this);else print('addToGroup error: '+group+' is not a group')};this.limitSpeed=function(max){var speed=this.getSpeed();if(abs(speed)>max){var k=max/abs(speed);this.velocity.x*=k;this.velocity.y*=k}};this.setSpeed=function(speed,angle){var a;if(typeof angle==='undefined'){if(this.velocity.x!==0||this.velocity.y!==0){a=pInst.atan2(this.velocity.y,this.velocity.x)}else{if(pInst._angleMode===pInst.RADIANS){a=radians(this._rotation)}else{a=this._rotation}}}else{if(pInst._angleMode===pInst.RADIANS){a=radians(angle)}else{a=angle}}
  this.velocity.x=cos(a)*speed;this.velocity.y=sin(a)*speed};this.setSpeedAndDirection=this.setSpeed;this.setFrame=function(f){if(this.animation){this.animation.changeFrame(f)}};this.nextFrame=function(){if(this.animation){this.animation.nextFrame()}};this.previousFrame=function(){if(this.animation){this.animation.previousFrame()}};this.pause=function(){if(this.animation){this.animation.stop()}};this.play=function(){if(!this.animation){return}
  if(!this.animation.looping&&!this.animation.playing&&this.animation.getFrame()===this.animation.images.length-1){this.animation.rewind()}
  this.animation.play()};this.frameDidChange=function(){return this.animation?this.animation.frameChanged:!1};this.pointTo=function(x,y){var yDelta=y-this.position.y;var xDelta=x-this.position.x;if(!isNaN(xDelta)&&!isNaN(yDelta)&&(xDelta!==0||yDelta!==0)){var radiansAngle=Math.atan2(yDelta,xDelta);this.rotation=360*radiansAngle/(2*Math.PI)}};this.addSpeed=function(speed,angle){var a;if(pInst._angleMode===pInst.RADIANS){a=radians(angle)}else{a=angle}
  this.velocity.x+=cos(a)*speed;this.velocity.y+=sin(a)*speed};this.attractionPoint=function(magnitude,pointX,pointY){var angle=atan2(pointY-this.position.y,pointX-this.position.x);this.velocity.x+=cos(angle)*magnitude;this.velocity.y+=sin(angle)*magnitude};this.addImage=function(){if(typeof arguments[0]==='string'&&arguments[1]instanceof p5.Image)
  this.addAnimation(arguments[0],arguments[1]);else if(arguments[0]instanceof p5.Image)
  this.addAnimation('normal',arguments[0]);else throw('addImage error: allowed usages are <image> or <label>, <image>')};this.addAnimation=function(label){var anim;if(typeof label!=='string'){print('Sprite.addAnimation error: the first argument must be a label (String)');return-1}else if(arguments.length<2){print('addAnimation error: you must specify a label and n frame images');return-1}else if(arguments[1]instanceof Animation){var sourceAnimation=arguments[1];var newAnimation=sourceAnimation.clone();animations[label]=newAnimation;if(currentAnimation===''){currentAnimation=label;this.animation=newAnimation}
  newAnimation.isSpriteAnimation=!0;this._internalWidth=newAnimation.getWidth()*abs(this._getScaleX());this._internalHeight=newAnimation.getHeight()*abs(this._getScaleY());return newAnimation}else{var animFrames=[];for(var i=1;i<arguments.length;i++)
  animFrames.push(arguments[i]);anim=construct(pInst.Animation,animFrames);animations[label]=anim;if(currentAnimation===''){currentAnimation=label;this.animation=anim}
  anim.isSpriteAnimation=!0;this._internalWidth=anim.getWidth()*abs(this._getScaleX());this._internalHeight=anim.getHeight()*abs(this._getScaleY());return anim}};this.changeImage=function(label){this.changeAnimation(label)};this.getAnimationLabel=function(){return currentAnimation};this.changeAnimation=function(label){if(!animations[label])
  print('changeAnimation error: no animation labeled '+label);else{currentAnimation=label;this.animation=animations[label]}};this.setAnimation=function(animationName){if(animationName===this.getAnimationLabel()){return}
  var animation=pInst._predefinedSpriteAnimations&&pInst._predefinedSpriteAnimations[animationName];if(typeof animation==='undefined'){throw new Error('Unable to find an animation named "'+animationName+'".  Please make sure the animation exists.')}
  this.addAnimation(animationName,animation);this.changeAnimation(animationName);if(pInst._pauseSpriteAnimationsByDefault){this.pause()}};this.overlapPixel=function(pointX,pointY){var point=createVector(pointX,pointY);var img=this.animation.getFrameImage();point.x-=this.position.x-img.width/2;point.y-=this.position.y-img.height/2;if(point.x<0||point.x>img.width||point.y<0||point.y>img.height)
  return!1;else if(this.rotation===0&&this.scale===1){var values=img.get(point.x,point.y);return values[3]===255}else{print('Error: overlapPixel doesn\'t work with scaled or rotated sprites yet');return!1}};this.overlapPoint=function(pointX,pointY){if(!this.collider)
  this.setDefaultCollider();if(this.collider){var point=new p5.PointCollider(new p5.Vector(pointX,pointY));return this.collider.overlap(point)}
  return!1};this.overlap=function(target,callback){return this._collideWith('overlap',target,callback)};this.isTouching=this.overlap;this.collide=function(target,callback){return this._collideWith('collide',target,callback)};this.displace=function(target,callback){return this._collideWith('displace',target,callback)};this.bounce=function(target,callback){return this._collideWith('bounce',target,callback)};this.bounceOff=function(target,callback){return this._collideWith('bounceOff',target,callback)};this._collideWith=function(type,target,callback){this.touching.left=!1;this.touching.right=!1;this.touching.top=!1;this.touching.bottom=!1;if(this.removed){return!1}
  var others=[];if(target instanceof Sprite){others.push(target)}else if(target instanceof Array){if(pInst.quadTree!==undefined&&pInst.quadTree.active){others=pInst.quadTree.retrieveFromGroup(this,target)}
  if(others.length===0){others=target}}else{throw('Error: overlap can only be checked between sprites or groups')}
  var result=!1;for(var i=0;i<others.length;i++){result=this._collideWithOne(type,others[i],callback)||result}
  return result};this._collideWithOne=function(type,other,callback){if(other===this||other.removed){return!1}
  if(this.collider===undefined){this.setDefaultCollider()}
  if(other.collider===undefined){other.setDefaultCollider()}
  if(!this.collider||!other.collider){return!1}
  var displacement=this._findDisplacement(other);if(displacement.x===0&&displacement.y===0){return!1}
  if(displacement.x>0)
  this.touching.left=!0;if(displacement.x<0)
  this.touching.right=!0;if(displacement.y<0)
  this.touching.bottom=!0;if(displacement.y>0)
  this.touching.top=!0;if(type==='displace'&&!other.immovable){other.position.sub(displacement)}else if((type==='collide'||type==='bounce'||type==='bounceOff')&&!this.immovable){this.position.add(displacement);this.previousPosition=createVector(this.position.x,this.position.y);this.newPosition=createVector(this.position.x,this.position.y);this.collider.updateFromSprite(this)}
  var originalType=type;var originalThisImmovable=this.immovable;var originalOtherImmovable=other.immovable;var originalOtherRestitution=other.restitution;if(originalType==='collide'){type='bounce';other.immovable=!0;other.restitution=0}else if(originalType==='bounceOff'){type='bounce';other.immovable=!0}
  if(type==='bounce'){var thisInitialVelocity=p5.Vector.project(this.velocity,displacement);var otherInitialVelocity=p5.Vector.project(other.velocity,displacement);var thisMass=this.mass;var otherMass=other.mass;if(this.immovable){thisMass=1;otherMass=0}else if(other.immovable){thisMass=0;otherMass=1}
  var combinedMass=thisMass+otherMass;var coefficientOfRestitution=this.restitution*other.restitution;var initialMomentum=p5.Vector.add(p5.Vector.mult(thisInitialVelocity,thisMass),p5.Vector.mult(otherInitialVelocity,otherMass));var thisFinalVelocity=p5.Vector.sub(otherInitialVelocity,thisInitialVelocity).mult(otherMass*coefficientOfRestitution).add(initialMomentum).div(combinedMass);var otherFinalVelocity=p5.Vector.sub(thisInitialVelocity,otherInitialVelocity).mult(thisMass*coefficientOfRestitution).add(initialMomentum).div(combinedMass);this.velocity.sub(thisInitialVelocity).add(thisFinalVelocity);other.velocity.sub(otherInitialVelocity).add(otherFinalVelocity)}
  type=originalType;this.immovable=originalThisImmovable;other.immovable=originalOtherImmovable;other.restitution=originalOtherRestitution;if(typeof callback==='function'&&type!=='isTouching'){callback.call(this,this,other)}
  return!0};this._findDisplacement=function(target){if(this._doSweptCollidersOverlap(target)){var radiusOnVelocityAxis=Math.max(this.collider._getMinRadius(),target.collider._getMinRadius());var relativeVelocity=p5.Vector.sub(this.velocity,target.velocity).mag();var timestep=Math.max(0.015,radiusOnVelocityAxis/relativeVelocity);if(timestep<1){var thisOriginalPosition=this.position.copy();var targetOriginalPosition=target.position.copy();this.position.set(this.previousPosition);target.position.set(target.previousPosition);var thisDelta=p5.Vector.sub(thisOriginalPosition,this.previousPosition).mult(timestep);var targetDelta=p5.Vector.sub(targetOriginalPosition,target.previousPosition).mult(timestep);for(var i=timestep;i<1;i+=timestep){this.position.add(thisDelta);target.position.add(targetDelta);this.collider.updateFromSprite(this);target.collider.updateFromSprite(target);var displacement=this.collider.collide(target.collider);if(displacement.x!==0||displacement.y!==0){if(this.immovable){this.position.set(thisOriginalPosition)}
  if(target.immovable){target.position.set(targetOriginalPosition)}
  return displacement}}
  this.position.set(thisOriginalPosition);target.position.set(targetOriginalPosition)}}
  this.collider.updateFromSprite(this);target.collider.updateFromSprite(target);return this.collider.collide(target.collider)}}
  defineLazyP5Property('Sprite',boundConstructorFactory(Sprite));function Camera(pInst,x,y,zoom){this.position=pInst.createVector(x,y);Object.defineProperty(this,'x',{enumerable:!0,get:function(){return this.position.x},set:function(value){this.position.x=value}});Object.defineProperty(this,'y',{enumerable:!0,get:function(){return this.position.y},set:function(value){this.position.y=value}});this.zoom=zoom;this.mouseX=pInst.mouseX;this.mouseY=pInst.mouseY;this.active=!1;this.isActive=function(){return this.active};this.on=function(){if(!this.active){cameraPush.call(pInst);this.active=!0}};this.off=function(){if(this.active){cameraPop.call(pInst);this.active=!1}}}
  defineLazyP5Property('Camera',boundConstructorFactory(Camera));function cameraPush(){var pInst=this;var camera=pInst.camera;if(!camera.init&&camera.position.x===0&&camera.position.y===0){camera.position.x=pInst.width/2;camera.position.y=pInst.height/2;camera.init=!0}
  camera.mouseX=pInst.mouseX+camera.position.x-pInst.width/2;camera.mouseY=pInst.mouseY+camera.position.y-pInst.height/2;if(!camera.active){camera.active=!0;pInst.push();pInst.scale(camera.zoom);pInst.translate(-camera.position.x+pInst.width/2/camera.zoom,-camera.position.y+pInst.height/2/camera.zoom)}}
  function cameraPop(){var pInst=this;if(pInst.camera.active){pInst.pop();pInst.camera.active=!1}}
  function Group(){var array=[];array.get=function(i){return array[i]};array.contains=function(sprite){return this.indexOf(sprite)>-1};array.indexOf=function(item){for(var i=0,len=array.length;i<len;++i){if(virtEquals(item,array[i])){return i}}
  return-1};array.add=function(s){if(!(s instanceof Sprite)){throw('Error: you can only add sprites to a group')}
  if(-1===this.indexOf(s)){array.push(s);s.groups.push(this)}};array.size=function(){return array.length};array.removeSprites=function(){while(array.length>0){array[0].remove()}};array.clear=function(){array.length=0};array.remove=function(item){if(!(item instanceof Sprite)){throw('Error: you can only remove sprites from a group')}
  var i,removed=!1;for(i=array.length-1;i>=0;i--){if(array[i]===item){array.splice(i,1);removed=!0}}
  if(removed){for(i=item.groups.length-1;i>=0;i--){if(item.groups[i]===this){item.groups.splice(i,1)}}}
  return removed};array.toArray=function(){return array.slice(0)};array.maxDepth=function(){if(array.length===0){return 0}
  return array.reduce(function(maxDepth,sprite){return Math.max(maxDepth,sprite.depth)},-Infinity)};array.minDepth=function(){if(array.length===0){return 99999}
  return array.reduce(function(minDepth,sprite){return Math.min(minDepth,sprite.depth)},Infinity)};array.draw=function(){this.sort(function(a,b){return a.depth-b.depth});for(var i=0;i<this.size();i++){this.get(i).display()}};function virtEquals(obj,other){if(obj===null||other===null){return(obj===null)&&(other===null)}
  if(typeof(obj)==='string'){return obj===other}
  if(typeof(obj)!=='object'){return obj===other}
  if(obj.equals instanceof Function){return obj.equals(other)}
  return obj===other}
  function _groupCollide(type,target,callback){var didCollide=!1;for(var i=0;i<this.size();i++)
  didCollide=this.get(i)._collideWith(type,target,callback)||didCollide;return didCollide}
  array.overlap=_groupCollide.bind(array,'overlap');array.isTouching=array.overlap;array.collide=_groupCollide.bind(array,'collide');array.displace=_groupCollide.bind(array,'displace');array.bounce=_groupCollide.bind(array,'bounce');array.bounceOff=_groupCollide.bind(array,'bounceOff');array.setPropertyEach=function(propName,value){for(var i=0;i<this.length;i++){this[i][propName]=value}};array.callMethodEach=function(methodName){var methodArgs=Array.prototype.slice.call(arguments,1);var elements=[].concat(this);for(var i=0;i<elements.length;i++){elements[i][methodName].apply(elements[i],methodArgs)}};array.setDepthEach=array.setPropertyEach.bind(array,'depth');array.setLifetimeEach=array.setPropertyEach.bind(array,'lifetime');array.setRotateToDirectionEach=array.setPropertyEach.bind(array,'rotateToDirection');array.setRotationEach=array.setPropertyEach.bind(array,'rotation');array.setRotationSpeedEach=array.setPropertyEach.bind(array,'rotationSpeed');array.setScaleEach=array.setPropertyEach.bind(array,'scale');array.setColorEach=array.setPropertyEach.bind(array,'shapeColor');array.setTintEach=array.setPropertyEach.bind(array,'tint');array.setVisibleEach=array.setPropertyEach.bind(array,'visible');array.setVelocityXEach=array.setPropertyEach.bind(array,'velocityX');array.setVelocityYEach=array.setPropertyEach.bind(array,'velocityY');array.setHeightEach=array.setPropertyEach.bind(array,'height');array.setWidthEach=array.setPropertyEach.bind(array,'width');array.destroyEach=array.callMethodEach.bind(array,'destroy');array.pointToEach=array.callMethodEach.bind(array,'pointTo');array.setAnimationEach=array.callMethodEach.bind(array,'setAnimation');array.setColliderEach=array.callMethodEach.bind(array,'setCollider');array.setSpeedAndDirectionEach=array.callMethodEach.bind(array,'setSpeedAndDirection');array.setVelocityEach=array.callMethodEach.bind(array,'setVelocity');array.setMirrorXEach=array.callMethodEach.bind(array,'mirrorX');array.setMirrorYEach=array.callMethodEach.bind(array,'mirrorY');return array}
  p5.prototype.Group=Group;p5.prototype.createEdgeSprites=function(){if(this.edges){return this.edges}
  var edgeThickness=100;var width=this._curElement.elt.offsetWidth;var height=this._curElement.elt.offsetHeight;this.leftEdge=this.createSprite(-edgeThickness/2,height/2,edgeThickness,height);this.rightEdge=this.createSprite(width+(edgeThickness/2),height/2,edgeThickness,height);this.topEdge=this.createSprite(width/2,-edgeThickness/2,width,edgeThickness);this.bottomEdge=this.createSprite(width/2,height+(edgeThickness/2),width,edgeThickness);this.edges=this.createGroup();this.edges.add(this.leftEdge);this.edges.add(this.rightEdge);this.edges.add(this.topEdge);this.edges.add(this.bottomEdge);return this.edges};function Animation(pInst){var frameArguments=Array.prototype.slice.call(arguments,1);var i;var CENTER=p5.prototype.CENTER;this.images=[];var frame=0;var cycles=0;var targetFrame=-1;this.offX=0;this.offY=0;this.frameDelay=4;this.playing=!0;this.visible=!0;this.looping=!0;this.frameChanged=!1;this.imageCollider=!1;if(frameArguments.length===2&&typeof frameArguments[0]==='string'&&typeof frameArguments[1]==='string'){var from=frameArguments[0];var to=frameArguments[1];var ext1=from.substring(from.length-4,from.length);if(ext1!=='.png'){pInst.print('Animation error: you need to use .png files (filename '+from+')');from=-1}
  var ext2=to.substring(to.length-4,to.length);if(ext2!=='.png'){pInst.print('Animation error: you need to use .png files (filename '+to+')');to=-1}
  if(from!==-1&&to!==-1){var digits1=0;var digits2=0;for(i=from.length-5;i>=0;i--){if(from.charAt(i)>='0'&&from.charAt(i)<='9')
  digits1++}
  for(i=to.length-5;i>=0;i--){if(to.charAt(i)>='0'&&to.charAt(i)<='9')
  digits2++}
  var prefix1=from.substring(0,from.length-(4+digits1));var prefix2=to.substring(0,to.length-(4+digits2));var number1=parseInt(from.substring(from.length-(4+digits1),from.length-4),10);var number2=parseInt(to.substring(to.length-(4+digits2),to.length-4),10);if(number2<number1){var t=number2;number2=number1;number1=t}
  if(prefix1!==prefix2){this.images.push(pInst.loadImage(from));this.images.push(pInst.loadImage(to))}else{var fileName;if(digits1===digits2){for(i=number1;i<=number2;i++){fileName=prefix1+pInst.nf(i,digits1)+'.png';this.images.push(pInst.loadImage(fileName))}}else{for(i=number1;i<=number2;i++){fileName=prefix1+i+'.png';this.images.push(pInst.loadImage(fileName))}}}}}else if(frameArguments.length===1&&(frameArguments[0]instanceof SpriteSheet)){this.spriteSheet=frameArguments[0];this.images=this.spriteSheet.frames.map(function(f){if(f.spriteSourceSize&&f.sourceSize){return Object.assign(f.frame,{width:f.frame.w,height:f.frame.h,sourceX:f.spriteSourceSize.x,sourceY:f.spriteSourceSize.y,sourceW:f.sourceSize.w,sourceH:f.sourceSize.h,})}
  return f.frame})}else if(frameArguments.length!==0){for(i=0;i<frameArguments.length;i++){if(frameArguments[i]instanceof p5.Image)
  this.images.push(frameArguments[i]);else this.images.push(pInst.loadImage(frameArguments[i]))}}
  this.clone=function(){var myClone=new Animation(pInst);myClone.images=[];if(this.spriteSheet){myClone.spriteSheet=this.spriteSheet.clone()}
  myClone.images=this.images.slice();myClone.offX=this.offX;myClone.offY=this.offY;myClone.frameDelay=this.frameDelay;myClone.playing=this.playing;myClone.looping=this.looping;return myClone};this.draw=function(x,y,r){this.xpos=x;this.ypos=y;this.rotation=r||0;if(this.visible){if(!this.isSpriteAnimation)
  this.update();pInst.push();pInst.imageMode(CENTER);var xTranslate=this.xpos;var yTranslate=this.ypos;var image=this.images[frame];var frame_info=this.spriteSheet&&image;if(frame_info){var missingX=(frame_info.sourceW||frame_info.width)-frame_info.width;var missingY=(frame_info.sourceH||frame_info.height)-frame_info.height;xTranslate+=((frame_info.sourceX||0)-missingX/2);yTranslate+=((frame_info.sourceY||0)-missingY/2)}
  pInst.translate(xTranslate,yTranslate);if(pInst._angleMode===pInst.RADIANS){pInst.rotate(radians(this.rotation))}else{pInst.rotate(this.rotation)}
  if(frame_info){if(this.spriteSheet.image instanceof Image){pInst.imageElement(this.spriteSheet.image,frame_info.x,frame_info.y,frame_info.width,frame_info.height,this.offX,this.offY,frame_info.width,frame_info.height)}else{pInst.image(this.spriteSheet.image,frame_info.x,frame_info.y,frame_info.width,frame_info.height,this.offX,this.offY,frame_info.width,frame_info.height)}}else if(image){if(image instanceof Image){pInst.imageElement(image,this.offX,this.offY)}else{pInst.image(image,this.offX,this.offY)}}else{pInst.print('Warning undefined frame '+frame)}
  pInst.pop()}};this.update=function(){cycles++;var previousFrame=frame;this.frameChanged=!1;if(this.images.length===1){this.playing=!1;frame=0}
  if(this.playing&&cycles%this.frameDelay===0){if(targetFrame>frame&&targetFrame!==-1){frame++}else if(targetFrame<frame&&targetFrame!==-1){frame--}else if(targetFrame===frame&&targetFrame!==-1){this.playing=!1}else if(this.looping){if(frame>=this.images.length-1)
  frame=0;else frame++}else{if(frame<this.images.length-1)
  frame++;else this.playing=!1}}
  if(previousFrame!==frame)
  this.frameChanged=!0};this.play=function(){this.playing=!0;targetFrame=-1};this.stop=function(){this.playing=!1};this.rewind=function(){frame=0};this.changeFrame=function(f){if(f<this.images.length)
  frame=f;else frame=this.images.length-1;targetFrame=-1};this.nextFrame=function(){if(frame<this.images.length-1)
  frame=frame+1;else if(this.looping)
  frame=0;targetFrame=-1;this.playing=!1};this.previousFrame=function(){if(frame>0)
  frame=frame-1;else if(this.looping)
  frame=this.images.length-1;targetFrame=-1;this.playing=!1};this.goToFrame=function(toFrame){if(toFrame<0||toFrame>=this.images.length){return}
  targetFrame=toFrame;if(targetFrame!==frame){this.playing=!0}};this.getFrame=function(){return frame};this.getLastFrame=function(){return this.images.length-1};this.getFrameImage=function(){return this.images[frame]};this.getImageAt=function(f){return this.images[f]};this.getWidth=function(){if(this.images[frame]){return this.images[frame].sourceW||this.images[frame].width}else{return 1}};this.getHeight=function(){if(this.images[frame]){return this.images[frame].sourceH||this.images[frame].height}else{return 1}}}
  defineLazyP5Property('Animation',boundConstructorFactory(Animation));function SpriteSheet(pInst){var spriteSheetArgs=Array.prototype.slice.call(arguments,1);this.image=null;this.frames=[];this.frame_width=0;this.frame_height=0;this.num_frames=0;this._generateSheetFrames=function(){var sX=0,sY=0;for(var i=0;i<this.num_frames;i++){this.frames.push({'name':i,'frame':{'x':sX,'y':sY,'width':this.frame_width,'height':this.frame_height}});sX+=this.frame_width;if(sX>=this.image.width){sX=0;sY+=this.frame_height;if(sY>=this.image.height){sY=0}}}};var shortArgs=spriteSheetArgs.length===2||spriteSheetArgs.length===3;var longArgs=spriteSheetArgs.length===4||spriteSheetArgs.length===5;if(shortArgs&&Array.isArray(spriteSheetArgs[1])){this.frames=spriteSheetArgs[1];this.num_frames=this.frames.length}else if(longArgs&&(typeof spriteSheetArgs[1]==='number')&&(typeof spriteSheetArgs[2]==='number')&&(typeof spriteSheetArgs[3]==='number')){this.frame_width=spriteSheetArgs[1];this.frame_height=spriteSheetArgs[2];this.num_frames=spriteSheetArgs[3]}
  if(spriteSheetArgs[0]instanceof p5.Image||spriteSheetArgs[0]instanceof Image){this.image=spriteSheetArgs[0];if(longArgs){this._generateSheetFrames()}}else{var callback;if(shortArgs){if(spriteSheetArgs[2]){if(typeof spriteSheetArgs[2]==='function'){callback=spriteSheetArgs[2]}
  this.image=pInst.loadImageElement(spriteSheetArgs[0],function(img){if(callback)return callback(img);},function(){if(callback)return callback(null);})}else{this.image=pInst.loadImage(spriteSheetArgs[0])}}else if(longArgs){var generateSheetFrames=this._generateSheetFrames.bind(this);if(spriteSheetArgs[4]){if(typeof spriteSheetArgs[4]==='function'){callback=spriteSheetArgs[4]}
  this.image=pInst.loadImageElement(spriteSheetArgs[0],function(img){generateSheetFrames(img);if(callback)return callback(img);},function(){if(callback)return callback(null);})}else{this.image=pInst.loadImage(spriteSheetArgs[0],generateSheetFrames)}}}
  this.drawFrame=function(frame_name,x,y,width,height){var frameToDraw;if(typeof frame_name==='number'){frameToDraw=this.frames[frame_name]}else{for(var i=0;i<this.frames.length;i++){if(this.frames[i].name===frame_name){frameToDraw=this.frames[i];break}}}
  var frameWidth=frameToDraw.frame.width||frameToDraw.frame.w;var frameHeight=frameToDraw.frame.height||frameToDraw.frame.h;var dWidth=width||frameWidth;var dHeight=height||frameHeight;if(frameToDraw.spriteSourceSize&&frameToDraw.sourceSize){var frameSizeScaleX=frameWidth/frameToDraw.sourceSize.w;var frameSizeScaleY=frameHeight/frameToDraw.sourceSize.h;if(width){x+=(frameToDraw.spriteSourceSize.x*dWidth/frameToDraw.sourceSize.w);dWidth=width*frameSizeScaleX}else{x+=frameToDraw.spriteSourceSize.x}
  if(height){y+=(frameToDraw.spriteSourceSize.y*dHeight/frameToDraw.sourceSize.h);dHeight=height*frameSizeScaleY}else{y+=frameToDraw.spriteSourceSize.y}}
  if(this.image instanceof Image){pInst.imageElement(this.image,frameToDraw.frame.x,frameToDraw.frame.y,frameToDraw.frame.width,frameToDraw.frame.height,x,y,dWidth,dHeight)}else{pInst.image(this.image,frameToDraw.frame.x,frameToDraw.frame.y,frameToDraw.frame.width,frameToDraw.frame.height,x,y,dWidth,dHeight)}};this.clone=function(){var myClone=new SpriteSheet(pInst);for(var i=0;i<this.frames.length;i++){var frame=this.frames[i].frame;var cloneFrame={'name':frame.name,'frame':{'x':frame.x,'y':frame.y,'width':frame.width,'height':frame.height}};myClone.frames.push(cloneFrame)}
  myClone.image=this.image;myClone.frame_width=this.frame_width;myClone.frame_height=this.frame_height;myClone.num_frames=this.num_frames;return myClone}}
  defineLazyP5Property('SpriteSheet',boundConstructorFactory(SpriteSheet));function construct(constructor,args){function F(){return constructor.apply(this,args)}
  F.prototype=constructor.prototype;return new F()}
  function Quadtree(bounds,max_objects,max_levels,level){this.active=!0;this.max_objects=max_objects||10;this.max_levels=max_levels||4;this.level=level||0;this.bounds=bounds;this.objects=[];this.object_refs=[];this.nodes=[]}
  Quadtree.prototype.updateBounds=function(){var objects=this.getAll();var x=10000;var y=10000;var w=-10000;var h=-10000;for(var i=0;i<objects.length;i++){if(objects[i].position.x<x)
  x=objects[i].position.x;if(objects[i].position.y<y)
  y=objects[i].position.y;if(objects[i].position.x>w)
  w=objects[i].position.x;if(objects[i].position.y>h)
  h=objects[i].position.y}
  this.bounds={x:x,y:y,width:w,height:h}};Quadtree.prototype.split=function(){var nextLevel=this.level+1,subWidth=Math.round(this.bounds.width/2),subHeight=Math.round(this.bounds.height/2),x=Math.round(this.bounds.x),y=Math.round(this.bounds.y);this.nodes[0]=new Quadtree({x:x+subWidth,y:y,width:subWidth,height:subHeight},this.max_objects,this.max_levels,nextLevel);this.nodes[1]=new Quadtree({x:x,y:y,width:subWidth,height:subHeight},this.max_objects,this.max_levels,nextLevel);this.nodes[2]=new Quadtree({x:x,y:y+subHeight,width:subWidth,height:subHeight},this.max_objects,this.max_levels,nextLevel);this.nodes[3]=new Quadtree({x:x+subWidth,y:y+subHeight,width:subWidth,height:subHeight},this.max_objects,this.max_levels,nextLevel)};Quadtree.prototype.getIndex=function(pRect){if(!pRect.collider)
  return-1;else{var colliderBounds=pRect.collider.getBoundingBox();var index=-1,verticalMidpoint=this.bounds.x+(this.bounds.width/2),horizontalMidpoint=this.bounds.y+(this.bounds.height/2),topQuadrant=(colliderBounds.top<horizontalMidpoint&&colliderBounds.bottom<horizontalMidpoint),bottomQuadrant=(colliderBounds.top>horizontalMidpoint);if(colliderBounds.left<verticalMidpoint&&colliderBounds.right<verticalMidpoint){if(topQuadrant){index=1}else if(bottomQuadrant){index=2}}else if(colliderBounds.left>verticalMidpoint){if(topQuadrant){index=0}else if(bottomQuadrant){index=3}}
  return index}};Quadtree.prototype.insert=function(obj){if(this.objects.indexOf(obj)===-1){var i=0,index;if(typeof this.nodes[0]!=='undefined'){index=this.getIndex(obj);if(index!==-1){this.nodes[index].insert(obj);return}}
  this.objects.push(obj);if(this.objects.length>this.max_objects&&this.level<this.max_levels){if(typeof this.nodes[0]==='undefined'){this.split()}
  while(i<this.objects.length){index=this.getIndex(this.objects[i]);if(index!==-1){this.nodes[index].insert(this.objects.splice(i,1)[0])}else{i=i+1}}}}};Quadtree.prototype.retrieve=function(pRect){var index=this.getIndex(pRect),returnObjects=this.objects;if(typeof this.nodes[0]!=='undefined'){if(index!==-1){returnObjects=returnObjects.concat(this.nodes[index].retrieve(pRect))}else{for(var i=0;i<this.nodes.length;i=i+1){returnObjects=returnObjects.concat(this.nodes[i].retrieve(pRect))}}}
  return returnObjects};Quadtree.prototype.retrieveFromGroup=function(pRect,group){var results=[];var candidates=this.retrieve(pRect);for(var i=0;i<candidates.length;i++)
  if(group.contains(candidates[i]))
  results.push(candidates[i]);return results};Quadtree.prototype.getAll=function(){var objects=this.objects;for(var i=0;i<this.nodes.length;i=i+1){objects=objects.concat(this.nodes[i].getAll())}
  return objects};Quadtree.prototype.getObjectNode=function(obj){var index;if(!this.nodes.length){return this}else{index=this.getIndex(obj);if(index===-1){return this}else{var node=this.nodes[index].getObjectNode(obj);if(node)return node}}
  return!1};Quadtree.prototype.removeObject=function(obj){var node=this.getObjectNode(obj),index=node.objects.indexOf(obj);if(index===-1)return!1;node.objects.splice(index,1)};Quadtree.prototype.clear=function(){this.objects=[];if(!this.nodes.length)return;for(var i=0;i<this.nodes.length;i=i+1){this.nodes[i].clear()}
  this.nodes=[]};Quadtree.prototype.cleanup=function(){var objects=this.getAll();this.clear();for(var i=0;i<objects.length;i++){this.insert(objects[i])}};function updateTree(){if(this.quadTree.active){this.quadTree.updateBounds();this.quadTree.cleanup()}}
  p5.prototype.registerMethod('pre',p5.prototype.readPresses);p5.prototype.registerMethod('pre',p5.prototype.updateSprites);p5.prototype.registerMethod('post',updateTree);p5.prototype.registerMethod('pre',cameraPush);p5.prototype.registerMethod('post',cameraPop);p5.prototype.registerPreloadMethod('loadImageElement',p5.prototype);p5.prototype._warn=function(message){var console=window.console;if(console){if('function'===typeof console.warn){console.warn(message)}else if('function'===typeof console.log){console.log('Warning: '+message)}}};p5.CollisionShape=function(center,rotation){this._localTransform=new p5.Transform2D();if(rotation){this._localTransform.rotate(rotation)}
  if(center){this._localTransform.translate(center)}
  this._parentTransform=new p5.Transform2D();this._center=new p5.Vector();this._offset=new p5.Vector();this._rotation=0;this._scale=new p5.Vector(1,1);this.getsDimensionsFromSprite=!1;Object.defineProperties(this,{'center':{enumerable:!0,get:function(){return this._center.copy()}.bind(this),set:function(c){this._localTransform.translate(p5.Vector.mult(this._center,-1)).translate(c);this._onTransformChanged()}.bind(this)},'offset':{enumerable:!0,get:function(){return this._offset.copy()}.bind(this),set:function(o){this._localTransform.translate(p5.Vector.mult(this._offset,-1)).translate(o);this._onTransformChanged()}.bind(this)},'rotation':{enumerable:!0,get:function(){return this._rotation}.bind(this),set:function(r){this._localTransform.clear().scale(this._scale).rotate(r).translate(this._offset);this._onTransformChanged()}.bind(this)},'scale':{enumerable:!0,get:function(){return this._scale.copy()}.bind(this),set:function(s){this._localTransform.clear().scale(s).rotate(this._rotation).translate(this._offset);this._onTransformChanged()}.bind(this)}});this._onTransformChanged()};p5.CollisionShape.prototype.updateFromSprite=function(sprite){this.setParentTransform(sprite)};p5.CollisionShape.prototype.setParentTransform=function(parent){if(parent instanceof Sprite){this._parentTransform.clear().scale(parent._getScaleX(),parent._getScaleY()).rotate(radians(parent.rotation)).translate(parent.position)}else if(parent instanceof p5.Transform2D){this._parentTransform=parent.copy()}else{throw new TypeError('Bad argument to setParentTransform: '+parent)}
  this._onTransformChanged()};p5.CollisionShape.prototype._onTransformChanged=function(){this._rotation=this._localTransform.getRotation();this._scale=this._localTransform.getScale();this._offset.set(0,0).transform(this._localTransform);this._center.set(this._offset.x,this._offset.y).transform(this._parentTransform)};p5.CollisionShape.prototype.collide=function(other){var displacee=this,displacer=other;var smallestOverlap=Infinity;var smallestOverlapAxis=null;var deltaOfCenters=p5.Vector.sub(displacer.center,displacee.center);var candidateAxes=p5.CollisionShape._getCandidateAxesForShapes(displacee,displacer);var axis,deltaOfCentersOnAxis,distanceOfCentersOnAxis;for(var i=0;i<candidateAxes.length;i++){axis=candidateAxes[i];deltaOfCentersOnAxis=p5.Vector.project(deltaOfCenters,axis);distanceOfCentersOnAxis=deltaOfCentersOnAxis.mag();var r1=displacee._getRadiusOnAxis(axis);var r2=displacer._getRadiusOnAxis(axis);var overlap=r1+r2-distanceOfCentersOnAxis;if(overlap<=0){return new p5.Vector()}else if(overlap<smallestOverlap){smallestOverlap=overlap;if(deltaOfCentersOnAxis.x===0&&deltaOfCentersOnAxis.y===0){smallestOverlapAxis=axis}else{smallestOverlapAxis=deltaOfCentersOnAxis}}}
  return smallestOverlapAxis.copy().setMag(-smallestOverlap)};p5.CollisionShape.prototype.overlap=function(other){var displacement=this.collide(other);return displacement.x!==0||displacement.y!==0};p5.CollisionShape._getCandidateAxesForShapes=function(shape1,shape2){var axes=shape1._getCandidateAxes(shape2).concat(shape2._getCandidateAxes(shape1)).map(function(axis){if(axis.x===0&&axis.y===0){return p5.CollisionShape.X_AXIS}
  return axis});return deduplicateParallelVectors(axes)};function deduplicateParallelVectors(array){return array.filter(function(item,itemPos){return!array.some(function(other,otherPos){return itemPos<otherPos&&item.isParallel(other)})})}
  p5.CollisionShape.prototype._getCandidateAxes=function(){return[]};p5.CollisionShape.prototype._getRadiusOnAxis=function(){return 0};p5.CollisionShape.prototype._getMinRadius=function(){return 0};p5.CollisionShape.X_AXIS=new p5.Vector(1,0);p5.CollisionShape.Y_AXIS=new p5.Vector(0,1);p5.CollisionShape.WORLD_AXES=[p5.CollisionShape.X_AXIS,p5.CollisionShape.Y_AXIS];p5.CollisionShape.prototype.getBoundingBox=function(){var radiusOnX=this._getRadiusOnAxis(p5.CollisionShape.X_AXIS);var radiusOnY=this._getRadiusOnAxis(p5.CollisionShape.Y_AXIS);return{top:this.center.y-radiusOnY,bottom:this.center.y+radiusOnY,left:this.center.x-radiusOnX,right:this.center.x+radiusOnX,width:radiusOnX*2,height:radiusOnY*2}};p5.PointCollider=function(center){p5.CollisionShape.call(this,center)};p5.PointCollider.prototype=Object.create(p5.CollisionShape.prototype);p5.PointCollider.createFromSprite=function(sprite,offset){var shape=new p5.PointCollider(offset);shape.setParentTransform(sprite);return shape};p5.PointCollider.prototype.draw=function(sketch){sketch.push();sketch.rectMode(sketch.CENTER);sketch.translate(this.center.x,this.center.y);sketch.noStroke();sketch.fill(0,255,0);sketch.ellipse(0,0,2,2);sketch.pop()};p5.CircleCollider=function(center,radius){p5.CollisionShape.call(this,center);this.radius=radius;this._scaledRadius=0;this._computeScaledRadius()};p5.CircleCollider.prototype=Object.create(p5.CollisionShape.prototype);p5.CircleCollider.createFromSprite=function(sprite,offset,radius){var customSize=typeof radius==='number';var shape=new p5.CircleCollider(offset,customSize?radius:1);shape.getsDimensionsFromSprite=!customSize;shape.updateFromSprite(sprite);return shape};p5.CircleCollider.prototype.updateFromSprite=function(sprite){if(this.getsDimensionsFromSprite){if(sprite.animation){this.radius=Math.max(sprite.animation.getWidth(),sprite.animation.getHeight())/2}else{this.radius=Math.max(sprite.width,sprite.height)/2}}
  this.setParentTransform(sprite)};p5.CircleCollider.prototype._onTransformChanged=function(){p5.CollisionShape.prototype._onTransformChanged.call(this);this._computeScaledRadius()};p5.CircleCollider.prototype._computeScaledRadius=function(){this._scaledRadius=new p5.Vector(this.radius,0).transform(this._localTransform).transform(this._parentTransform).sub(this.center).mag()};p5.CircleCollider.prototype.draw=function(sketch){sketch.push();sketch.noFill();sketch.stroke(0,255,0);sketch.rectMode(sketch.CENTER);sketch.ellipse(this.center.x,this.center.y,this._scaledRadius*2,this._scaledRadius*2);sketch.pop()};p5.CircleCollider.prototype.setParentTransform=function(parent){if(parent instanceof Sprite){this._parentTransform.clear().scale(Math.max(parent._getScaleX(),parent._getScaleY())).rotate(radians(parent.rotation)).translate(parent.position)}else if(parent instanceof p5.Transform2D){this._parentTransform=parent.copy()}else{throw new TypeError('Bad argument to setParentTransform: '+parent)}
  this._onTransformChanged()};p5.CircleCollider.prototype._getCandidateAxes=function(other){if(other instanceof p5.OrientedBoundingBoxCollider||other instanceof p5.AxisAlignedBoundingBoxCollider){var smallestSquareDistance=Infinity;var axisToClosestVertex=null;var halfDiagonals=other.halfDiagonals;[p5.Vector.add(other.center,halfDiagonals[0]),p5.Vector.add(other.center,halfDiagonals[1]),p5.Vector.sub(other.center,halfDiagonals[0]),p5.Vector.sub(other.center,halfDiagonals[1])].map(function(vertex){return vertex.sub(this.center)}.bind(this)).forEach(function(vector){var squareDistance=vector.magSq();if(squareDistance<smallestSquareDistance){smallestSquareDistance=squareDistance;axisToClosestVertex=vector}});return[axisToClosestVertex]}
  return[p5.Vector.sub(other.center,this.center)]};p5.CircleCollider.prototype._getRadiusOnAxis=function(){return this._scaledRadius};p5.CircleCollider.prototype._getMinRadius=function(){return this._scaledRadius};p5.AxisAlignedBoundingBoxCollider=function(center,width,height){p5.CollisionShape.call(this,center);this._width=width;this._height=height;this._halfDiagonals=[];Object.defineProperties(this,{'width':{enumerable:!0,get:function(){return this._width}.bind(this),set:function(w){this._width=w;this._halfDiagonals=this._computeHalfDiagonals()}.bind(this)},'height':{enumerable:!0,get:function(){return this._height}.bind(this),set:function(h){this._height=h;this._halfDiagonals=this._computeHalfDiagonals()}.bind(this)},'halfDiagonals':{enumerable:!0,get:function(){return this._halfDiagonals}.bind(this)}});this._computeHalfDiagonals()};p5.AxisAlignedBoundingBoxCollider.prototype=Object.create(p5.CollisionShape.prototype);p5.AxisAlignedBoundingBoxCollider.createFromSprite=function(sprite,offset,width,height){var customSize=typeof width==='number'&&typeof height==='number';var box=new p5.AxisAlignedBoundingBoxCollider(offset,customSize?width:1,customSize?height:1);box.getsDimensionsFromSprite=!customSize;box.updateFromSprite(sprite);return box};p5.AxisAlignedBoundingBoxCollider.prototype.updateFromSprite=function(sprite){if(this.getsDimensionsFromSprite){if(sprite.animation){this._width=sprite.animation.getWidth();this._height=sprite.animation.getHeight()}else{this._width=sprite.width;this._height=sprite.height}}
  this.setParentTransform(sprite)};p5.AxisAlignedBoundingBoxCollider.prototype._onTransformChanged=function(){p5.CollisionShape.prototype._onTransformChanged.call(this);this._computeHalfDiagonals()};p5.AxisAlignedBoundingBoxCollider.prototype._computeHalfDiagonals=function(){var composedTransform=p5.Transform2D.mult(this._parentTransform,this._localTransform);var transformedDiagonals=[new p5.Vector(this._width/2,-this._height/2),new p5.Vector(this._width/2,this._height/2),new p5.Vector(-this._width/2,this._height/2)].map(function(vertex){return vertex.transform(composedTransform).sub(this.center)}.bind(this));var halfWidth=Math.max(Math.abs(transformedDiagonals[0].x),Math.abs(transformedDiagonals[1].x));var halfHeight=Math.max(Math.abs(transformedDiagonals[1].y),Math.abs(transformedDiagonals[2].y));this._halfDiagonals=[new p5.Vector(halfWidth,-halfHeight),new p5.Vector(halfWidth,halfHeight)]};p5.AxisAlignedBoundingBoxCollider.prototype.draw=function(sketch){sketch.push();sketch.rectMode(sketch.CENTER);sketch.translate(this.center.x,this.center.y);sketch.noFill();sketch.stroke(0,255,0);sketch.strokeWeight(1);sketch.rect(0,0,Math.abs(this._halfDiagonals[0].x)*2,Math.abs(this._halfDiagonals[0].y)*2);sketch.pop()};p5.AxisAlignedBoundingBoxCollider.prototype._getCandidateAxes=function(){return p5.CollisionShape.WORLD_AXES};p5.AxisAlignedBoundingBoxCollider.prototype._getRadiusOnAxis=function(axis){return Math.max(p5.Vector.project(this._halfDiagonals[0],axis).mag(),p5.Vector.project(this._halfDiagonals[1],axis).mag())};p5.AxisAlignedBoundingBoxCollider.prototype._getMinRadius=function(){return Math.min(this._width,this._height)};p5.OrientedBoundingBoxCollider=function(center,width,height,rotation){p5.CollisionShape.call(this,center,rotation);this._width=width;this._height=height;this._potentialAxes=[];this._halfDiagonals=[];Object.defineProperties(this,{'width':{enumerable:!0,get:function(){return this._width}.bind(this),set:function(w){this._width=w;this._onTransformChanged()}.bind(this)},'height':{enumerable:!0,get:function(){return this._height}.bind(this),set:function(h){this._height=h;this._onTransformChanged()}.bind(this)},'halfDiagonals':{enumerable:!0,get:function(){return this._halfDiagonals}.bind(this)}});this._onTransformChanged()};p5.OrientedBoundingBoxCollider.prototype=Object.create(p5.CollisionShape.prototype);p5.OrientedBoundingBoxCollider.createFromSprite=function(sprite,offset,width,height,rotation){var customSize=typeof width==='number'&&typeof height==='number';var box=new p5.OrientedBoundingBoxCollider(offset,customSize?width:1,customSize?height:1,rotation);box.getsDimensionsFromSprite=!customSize;box.updateFromSprite(sprite);return box};p5.OrientedBoundingBoxCollider.prototype.updateFromSprite=p5.AxisAlignedBoundingBoxCollider.prototype.updateFromSprite;p5.OrientedBoundingBoxCollider.prototype.updateSweptColliderFromSprite=function(sprite){var vMagnitude=sprite.velocity.mag();var vPerpendicular=new p5.Vector(sprite.velocity.y,-sprite.velocity.x);this._width=vMagnitude+2*sprite.collider._getRadiusOnAxis(sprite.velocity);this._height=2*sprite.collider._getRadiusOnAxis(vPerpendicular);var newRotation=radians(sprite.getDirection());var newCenter=new p5.Vector(sprite.newPosition.x+0.5*sprite.velocity.x,sprite.newPosition.y+0.5*sprite.velocity.y);this._localTransform.clear().scale(this._scale).rotate(newRotation).translate(this._offset).translate(p5.Vector.mult(this._center,-1)).translate(newCenter);this._onTransformChanged()};p5.OrientedBoundingBoxCollider.prototype._onTransformChanged=function(){p5.CollisionShape.prototype._onTransformChanged.call(this);var composedTransform=p5.Transform2D.mult(this._parentTransform,this._localTransform);var transformedVertices=[new p5.Vector(this._width/2,-this._height/2),new p5.Vector(this._width/2,this._height/2),new p5.Vector(-this._width/2,this._height/2)].map(function(vertex){return vertex.transform(composedTransform)});this._halfDiagonals=[p5.Vector.sub(transformedVertices[0],this.center),p5.Vector.sub(transformedVertices[1],this.center)];this._potentialAxes=[p5.Vector.sub(transformedVertices[1],transformedVertices[2]),p5.Vector.sub(transformedVertices[1],transformedVertices[0])]};p5.OrientedBoundingBoxCollider.prototype.draw=function(sketch){var composedTransform=p5.Transform2D.mult(this._localTransform,this._parentTransform);var scale=composedTransform.getScale();var rotation=composedTransform.getRotation();sketch.push();sketch.translate(this.center.x,this.center.y);sketch.scale(scale.x,scale.y);if(sketch._angleMode===sketch.RADIANS){sketch.rotate(rotation)}else{sketch.rotate(degrees(rotation))}
  sketch.noFill();sketch.stroke(0,255,0);sketch.strokeWeight(1);sketch.rectMode(sketch.CENTER);sketch.rect(0,0,this._width,this._height);sketch.pop()};p5.OrientedBoundingBoxCollider.prototype._getCandidateAxes=function(){return this._potentialAxes};p5.OrientedBoundingBoxCollider.prototype._getRadiusOnAxis=p5.AxisAlignedBoundingBoxCollider.prototype._getRadiusOnAxis;p5.OrientedBoundingBoxCollider.prototype._getMinRadius=p5.AxisAlignedBoundingBoxCollider.prototype._getMinRadius;p5.Transform2D=function(source){source=source||[1,0,0,0,1,0];if(source.length!==6){throw new TypeError('Transform2D must have six components')}
  this.length=6;this[0]=source[0];this[1]=source[1];this[2]=source[2];this[3]=source[3];this[4]=source[4];this[5]=source[5]};p5.Transform2D.prototype=Object.create(Array.prototype);p5.Transform2D.prototype.clear=function(){this[0]=1;this[1]=0;this[2]=0;this[3]=0;this[4]=1;this[5]=0;return this};p5.Transform2D.prototype.copy=function(){return new p5.Transform2D(this)};p5.Transform2D.prototype.equals=function(other){if(!(other instanceof p5.Transform2D||Array.isArray(other))){return!1}
  for(var i=0;i<6;i++){if(this[i]!==other[i]){return!1}}
  return!0};p5.Transform2D.mult=function(t1,t2,dest){dest=dest||new p5.Transform2D();var t1_0,t1_1,t1_2,t1_3,t1_4,t1_5;t1_0=t1[0];t1_1=t1[1];t1_2=t1[2];t1_3=t1[3];t1_4=t1[4];t1_5=t1[5];var t2_0,t2_1,t2_2,t2_3,t2_4,t2_5;t2_0=t2[0];t2_1=t2[1];t2_2=t2[2];t2_3=t2[3];t2_4=t2[4];t2_5=t2[5];dest[0]=t1_0*t2_0+t1_1*t2_3;dest[1]=t1_0*t2_1+t1_1*t2_4;dest[2]=t1_0*t2_2+t1_1*t2_5+t1_2;dest[3]=t1_3*t2_0+t1_4*t2_3;dest[4]=t1_3*t2_1+t1_4*t2_4;dest[5]=t1_3*t2_2+t1_4*t2_5+t1_5;return dest};p5.Transform2D.prototype.mult=function(other){return p5.Transform2D.mult(this,other,this)};p5.Transform2D.prototype.translate=function(arg0,arg1){var x,y;if(arg0 instanceof p5.Vector){x=arg0.x;y=arg0.y}else if(typeof arg0==='number'&&typeof arg1==='number'){x=arg0;y=arg1}else{var args='';for(var i=0;i<arguments.length;i++){args+=arguments[i]+', '}
  throw new TypeError('Invalid arguments to Transform2D.translate: '+args)}
  return p5.Transform2D.mult([1,0,x,0,1,y],this,this)};p5.Transform2D.prototype.getTranslation=function(){return new p5.Vector(this[2],this[5])};p5.Transform2D.prototype.scale=function(arg0,arg1){var sx,sy;if(arg0 instanceof p5.Vector){sx=arg0.x;sy=arg0.y}else if(typeof arg0==='number'&&typeof arg1==='number'){sx=arg0;sy=arg1}else if(typeof arg0==='number'){sx=arg0;sy=arg0}else{throw new TypeError('Invalid arguments to Transform2D.scale: '+arguments)}
  return p5.Transform2D.mult([sx,0,0,0,sy,0],this,this)};p5.Transform2D.prototype.getScale=function(){var a=this[0],b=this[1],c=this[3],d=this[4];return new p5.Vector(sign(a)*Math.sqrt(a*a+b*b),sign(d)*Math.sqrt(c*c+d*d))};function sign(x){x=+x;if(x===0||isNaN(x)){return Number(x)}
  return x>0?1:-1}
  p5.Transform2D.prototype.rotate=function(radians){if(typeof radians!=='number'){throw new TypeError('Invalid arguments to Transform2D.rotate: '+arguments)}
  var sinR=Math.sin(radians);var cosR=Math.cos(radians);return p5.Transform2D.mult([cosR,-sinR,0,sinR,cosR,0],this,this)};p5.Transform2D.prototype.getRotation=function(){return Math.atan2(-this[1],this[0])};p5.Vector.transform=function(v,t){return v.copy().transform(t)};p5.Vector.prototype.transform=function(transform){var x=this.x;var y=this.y;this.x=transform[0]*x+transform[1]*y+transform[2];this.y=transform[3]*x+transform[4]*y+transform[5];return this}}))